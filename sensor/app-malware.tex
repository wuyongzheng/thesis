\section{Applying the Framework to Malware Detection} \label{sec:app-malware}

We apply our framework to three malware detection problems
by giving prototype malware detection implementations which
detect email spamming, DDoS attack and password cracking.
These are then evaluated with some experiments.

For the proof of concept implementation, we use
a simple setup with two kinds of environment sensors.
One sensor detects user presence at the host.
% This can be done in a variety of ways, ranging from motion sensors
% to infrared sensors to video cameras.
Another sensor records the temperature near the CPU as a proxy
for CPU usage.
% The first class of sensor records user activities while the
% second class measures the usage of computing resources.
Network traffic of the host is also monitored at the router.

In our experiments, the malicious activities are carried out by a
modified Agobot worm (also known as Gaobot)~\cite{Agobot}.
The worm is programmed with three tasks:
sending spam email to other email accounts using the SMTP protocol; 
carrying out a DDoS attack by flooding a target with UDP packets; 
and using the CPU resources on the host to perform password
cracking by hashing a dictionary of possible passwords.

The basic idea behind our detection rule is simple: the patterns of
legitimate resource usage when the user is  interacting with the
host, is different from that when no user is present.\footnote{
In this application, we do not distinguish between different users.
}
If the malware does not have/use user presence information, 
its behavior will not be correlated with the user presence. 
We divide the time into
intervals, in each interval, the user is either present or absent.
A detection algorithm is then applied to each interval to detect
malicious activity. The algorithms we have used are rate based detection,
moving average based detection, or changepoint
detection~\cite{wangInfocom02,ChangpointBook93}. 
Other detection algorithms such as 
variations of rate based detection algorithms are also applicable~\cite{chandola09}.
%The changepoint detection algorithm
%~\cite{wangInfocom02,ChangpointBook93} is then applied to each
%interval to detect malicious activity.
% \TODO{shift table to changepoint section}
% Table
% \ref{tbl:detect-malware} gives an overview of the detection rules, using our modified changepoint detection algorithm.
